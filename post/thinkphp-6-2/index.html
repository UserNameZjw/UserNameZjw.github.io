<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>ã€ŒThinkPHP 6.0ã€éƒ¨åˆ†é…ç½®ä¸æ§åˆ¶å™¨ | ã€Œè°¨è¨€æ…è¡Œã€</title>
<meta name="description" content="ä¸€ä½å¹´è¿‘ä¸‰åçš„ä¸­å¹´æ²¹è…»è‚¥èƒ–è€ç”·äººçš„ä¸­å¹´å±æœº">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://UserNameZjw.github.io/favicon.ico?v=1560935436932">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://UserNameZjw.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://UserNameZjw.github.io">
        <img src="https://UserNameZjw.github.io/images/avatar.png?v=1560935436932" class="site-logo">
        <h1 class="site-title">ã€Œè°¨è¨€æ…è¡Œã€</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      ä¸€ä½å¹´è¿‘ä¸‰åçš„ä¸­å¹´æ²¹è…»è‚¥èƒ–è€ç”·äººçš„ä¸­å¹´å±æœº
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://UserNameZjw.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">ã€ŒThinkPHP 6.0ã€éƒ¨åˆ†é…ç½®ä¸æ§åˆ¶å™¨</h2>
            <div class="post-date">2019-06-14</div>
            
              <div class="feature-container" style="background-image: url('https://UserNameZjw.github.io/post-images/thinkphp-6-2.jpg')">
              </div>
            
            <div class="post-content">
              <p>ThinkPHP 6.0 éƒ¨åˆ†é…ç½®<br>
ThinkPHP 6.0 æ§åˆ¶å™¨</p>
<!-- more -->
<blockquote>
<p>å¦‚æœæ˜¯ Nginx æœåŠ¡å™¨ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä¸æ˜¯å¤ªé«˜ï¼Œä½ éœ€è¦çœ‹ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ä¸­çš„ Nginx çš„è·¯ç”±è½¬å‘é…ç½®ï¼Œé¿å…ä¸€ä¸‹ä¸å¿…è¦çš„å‘</p>
</blockquote>
<p>å®˜ç½‘å‚è€ƒé“¾æ¥ï¼š<a href="https://www.kancloud.cn/manual/thinkphp6_0/1037488">TP6 URLè®¿é—®</a><br>
æ‰¾åˆ° ã€ŒNginxã€éƒ¨åˆ† å›¾â†“<br>
<img src="https://UserNameZjw.github.io/post-images/1560508162806.png" alt=""></p>
<pre><code>location / { // â€¦..çœç•¥éƒ¨åˆ†ä»£ç 
   if (!-e $request_filename) {
   		rewrite  ^(.*)$  /index.php?s=/$1  last;
    }
}
</code></pre>
<p>å¦‚æœä½ ç”¨çš„æ˜¯è·Ÿæˆ‘ä¸€æ ·çš„ MxSrvs è½¯ä»¶ï¼Œé…ç½®å¦‚ä¸‹â†“<br>
<img src="https://UserNameZjw.github.io/post-images/1560508384596.png" alt=""><br>
ç„¶åé‡å¯ Nginx æœåŠ¡å™¨å³å¯ã€‚</p>
<h3 id="å˜åŒ–">å˜åŒ–</h3>
<p>1.æ ¹ç›®å½•æ–‡ä»¶åå˜åŒ–</p>
<blockquote>
<p>ThinkPHP 5 ç‰ˆæœ¬(å›¾å·¦)æ˜¯ application æ–‡ä»¶å¤¹ï¼ŒThinkPHP 6 ç‰ˆæœ¬(å›¾å³)ç›´æ¥å‘½åå°±æ˜¯ app æ–‡ä»¶å¤¹ã€‚
<img src="https://UserNameZjw.github.io/post-images/1560509598577.png" alt=""></p>
</blockquote>
<p>2.é»˜è®¤ç”¨æ¨¡å¼</p>
<blockquote>
<p>ThinkPHP 6 é»˜è®¤æ˜¯å•åº”ç”¨æ¨¡å¼ï¼ŒTP5 ç‰ˆæœ¬é»˜è®¤æ˜¯å¤šåº”ç”¨æ¨¡å¼ã€‚<br>
TP6 çš„å¤šåº”ç”¨æ¨¡å¼éœ€è¦æ‰‹åŠ¨å¼€å¯æ”¯æŒã€‚<br>
å¼€å¯æ–¹æ³•ä¿®æ”¹ config/app.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º  'auto_multi_app'   =&gt; true å³å¯ã€‚<br>
å•ä¾‹æ¨¡å¼ä¸­ï¼Œåœ¨æ§åˆ¶å™¨ç©ºé—´å‘½åä¸­ï¼Œå¯ä»¥çœç•¥æ‰åº”ç”¨å index ï¼ˆä¸¾ä¾‹ï¼‰ã€‚<br>
å‘½åç©ºé—´<br>
TP5 å†™æ³•  <strong>namespace app\index\controller;</strong><br>
TP6 å†™æ³•  <strong>namespace app\controller;</strong>   (å•åº”ç”¨æ¨¡å¼)<br>
æ–‡ä»¶ä½ç½®<br>
TP5 æ–‡ä»¶ä½ç½® <strong>application/index/controller/Index.php</strong><br>
TP6 æ–‡ä»¶ä½ç½® <strong>app/controller/Index.php</strong><br>
å¤šåº”ç”¨å¼€å¯åï¼Œå°±éœ€è¦è·ŸTP5ä¸€æ ·çš„å†™æ³•</p>
</blockquote>
<p>æ³¨æ„ï¼šå¦‚æœå¼€å¯å¤šåº”ç”¨æ¨¡å¼ï¼Œéœ€è¦åˆ é™¤æ‰æ¡†æ¶é»˜è®¤è‡ªå¸¦çš„ controller æ–‡ä»¶å¤¹ï¼Œä¸ç„¶ä¼šä¾ç„¶æ¯æ¬¡è®¿é—®ï¼Œéƒ½é»˜è®¤åˆ° controller ã€‚</p>
<p>3.æ§åˆ¶å™¨å‘½åè§„èŒƒå˜åŒ–</p>
<blockquote>
<p>TP 5 ä¸­éœ€è¦æ§åˆ¶å™¨æ–‡ä»¶åå¿…é¡»é‡‡ç”¨é©¼å³°å‘½åï¼ˆé¦–å­—æ¯å¤§å†™: Indexï¼‰ã€‚<br>
TP6 ä¸­å…¼å®¹äº†æ™®é€šå†™æ³•ï¼Œæ–‡ä»¶åå®Œå…¨å°å†™: index ï¼Œåªéœ€è¦ä½ çš„ç±»åè·Ÿæ–‡ä»¶åä¿æŒä¸€è‡´å³å¯<br>
å‡è®¾ æ–‡ä»¶åä¸º index.php ï¼Œé‚£ä¹ˆç±»çš„å†™æ³•ä¸º class index{ } ã€‚</p>
</blockquote>
<p>4.æ”¯æŒæ§åˆ¶å™¨å¤§é©¼å³°å‘½å  (ä¸¤è€…éƒ½é»˜è®¤æ”¯æŒ)</p>
<blockquote>
<p>ä¸¾ä¾‹ï¼š<br>
æ§åˆ¶å™¨æ–‡ä»¶åä¸º HelloWorld.php ï¼Œç±»åä¿æŒä¸€è‡´ä¸º class HelloWorld { }<br>
æ–‡ä»¶è·¯å¾„ app\index\controller\HelloWorld.php<br>
è®¿é—®åœ°å€ http://localhost/index.php/hello_world<br>
ç°æ”¯æŒ http://localhost/index.php/HelloWorld  è®¿é—®
æ­¤åŠŸèƒ½é»˜è®¤å¼€å¯ï¼Œå¦‚æœæƒ³å…³é—­ï¼Œéœ€è¦ä¿®æ”¹ route.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º url_convert'   =&gt; false  å³å¯ã€‚</p>
</blockquote>
<p>5.æ§åˆ¶å™¨æ–‡ä»¶åé»˜è®¤çœç•¥ controller  åç¼€</p>
<blockquote>
<p>TP3.x ç‰ˆæœ¬ï¼Œå°±æ˜¯ä¸çœç•¥ controller åç¼€ï¼Œå¼€å¯å¯ä»¥ç”¨ä½œå…¼å®¹ä½ç‰ˆæœ¬æ–‡ä»¶æ¥ç”¨ã€‚<br>
é»˜è®¤æ§åˆ¶å™¨æ–‡ä»¶åæ ¼å¼ Index.phpï¼Œå¼€å¯åï¼Œéœ€è¦æŠŠæ§åˆ¶å™¨æ–‡ä»¶åæ ¼å¼å˜æ›´ä¸º IndexController.php<br>
å¼€å¯æ–¹æ³•ï¼Œä¿®æ”¹ route.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º 'controller_suffix'     =&gt; true</p>
</blockquote>
<p>6.é”™è¯¯ä¿¡æ¯</p>
<blockquote>
<p>TP6 ä¸­é»˜è®¤æ²¡æœ‰å¼€å¯é”™è¯¯ä¿¡æ¯<br>
åªéœ€è¦ä¿®æ”¹ config/app.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º 'show_error_msg'   =&gt; true å³å¯æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œé»˜è®¤å…³é—­ã€‚</p>
</blockquote>
<p>7.å¼€å¯å¼€å‘è°ƒè¯•æ¨¡å¼<br>
å‚è€ƒèµ„æ–™ï¼š<a href="https://www.kancloud.cn/manual/thinkphp6_0/1037618">TP6 å®˜æ–¹è°ƒè¯•æ¨¡å¼</a><br>
<img src="https://UserNameZjw.github.io/post-images/1560782224176.png" alt=""><br>
æ³¨æ„ï¼šæ˜¯æ–‡ä»¶å .example..env æŠŠ .env ä¹‹å‰çš„å…¨éƒ¨åˆ æ‰ï¼Œä»…ä»…ä¿ç•™ .env ã€‚<br>
ç„¶åæŠ¥é”™å›¾å¦‚ä¸‹â†“<br>
<img src="https://UserNameZjw.github.io/post-images/1560782376130.png" alt=""></p>
<h3 id="é…ç½®å°ç»“">é…ç½®å°ç»“</h3>
<p>æœ¬å°ç»“ä»…é™æœ¬æ–‡å‡ºç°ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–å¥½çš„é…ç½®ã€‚<br>
1.å¼€å¯å¤šåº”ç”¨æ¨¡å¼</p>
<blockquote>
<p>ä¿®æ”¹ config/app.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º  'auto_multi_app'   =&gt; true</p>
</blockquote>
<p>2.å…³é—­æ§åˆ¶å™¨å¤§é©¼å³°å‘½åè®¿é—®æ”¯æŒ</p>
<blockquote>
<p>ä¿®æ”¹ route.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º url_convert'   =&gt; false</p>
</blockquote>
<p>3.å¼€å¯é”™è¯¯ä¿¡æ¯</p>
<blockquote>
<p>ä¿®æ”¹ config/app.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º 'show_error_msg'   =&gt; true</p>
</blockquote>
<p>4.å¼€å¯æ§åˆ¶å™¨ä¸¥æ ¼æ¨¡å¼ï¼Œå³æ–‡ä»¶åä¸çœç•¥ Controller</p>
<blockquote>
<p>ä¿®æ”¹ route.php é…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸º 'controller_suffix'     =&gt; true</p>
</blockquote>
<p>5.å¼€å¯å¼€å‘è°ƒè¯•æ¨¡å¼</p>
<blockquote>
<p>åªéœ€è¦æŠŠæ ¹ç›®å½•ä¸‹ .example..env æ–‡ä»¶æ›´åä¸º <strong>.env</strong> å³å¯ã€‚</p>
</blockquote>
<h3 id="é…ç½®æ“ä½œ">é…ç½®æ“ä½œ</h3>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.kancloud.cn/manual/thinkphp6_0/1037484">ThinkPHP 6 å®˜æ–¹é…ç½®</a><br>
1.é…ç½®è·å–<br>
æ“ä½œé…ç½®ï¼Œéœ€è¦å¼•å…¥ Config ç±»æ–‡ä»¶</p>
<pre><code>use think\facade\Config;
</code></pre>
<p>2.è¯»å–é…ç½®  Config::get()</p>
<p>è¯»å–ä¸€çº§é…ç½®æ‰€æœ‰å‚æ•°</p>
<pre><code>Config::get('app');
Config::get('route');
</code></pre>
<p>è¯»å–å•ä¸ªé…ç½®</p>
<pre><code>Config::get('app.app_name');
Config::get('route.url_domain_root');
</code></pre>
<p>è¯»å–æ•°ç»„é…ç½®</p>
<pre><code>Config::get('database.default.host');
</code></pre>
<p>3.åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½®  Config::has()</p>
<pre><code>Config::has('template');
Config::has('route.route_rule_merge');
</code></pre>
<p>4.ä¿®æ”¹é…ç½®  Config::set()<br>
ä¸åœ¨æ”¯æŒå•ä¸ªé…ç½®æ›´æ–°ï¼Œéœ€è¦æ•°ç»„æ‰¹é‡æ›´æ–°é…ç½®</p>
<pre><code>&lt;?php
namespace app\index\controller;
use think\facade\Config;
class Index
{
    public function index()
    {
        //åŸä¸ºtrue 
        Config::set([&quot;show_error_msg&quot; =&gt; false],'app');
        $a = Config::get(&quot;app&quot;);
        var_dump($a);
    }
}
</code></pre>
<h3 id="æ§åˆ¶å™¨">æ§åˆ¶å™¨</h3>
<p>1.ç»å…¸å‹æ§åˆ¶å™¨(å¤šåº”ç”¨æ¨¡å¼)</p>
<pre><code>&lt;?php
namespace app\index\controller;

class Index
{
    public function index()
    {
        return 'index';
    }
}
</code></pre>
<p>æ–‡ä»¶ä½ç½®ï¼šapp\index\controller\Index.php<br>
è®¿é—®URLï¼šhttp://localhost/index.php/index</p>
<p>2.å¤šçº§æ§åˆ¶å™¨(ç†è®ºæ”¯æŒæ— é™çº§)<br>
æ³¨æ„å¤šçº§æ§åˆ¶çš„å‘½åç©ºé—´å†™æ³•</p>
<pre><code>&lt;?php
namespace app\index\controller\user;

class  Blog 
{
    public function index()
    {
        return 'index';
    }
    
}
</code></pre>
<p>æ–‡ä»¶ä½ç½®ï¼šapp/index/controller/user/Blog.php<br>
è®¿é—®URLï¼šhttp://localhost/index.php/user.blog/index<br>
æ³¨æ„äº‹é¡¹å¦‚ä¸‹â†“<br>
<img src="https://UserNameZjw.github.io/post-images/1560519428516.png" alt=""></p>
<p>3.å¼•ç”¨å…¶ä»–æ¨¡å—ç±» éœ€è¦ use å‘½åç©ºé—´</p>
<pre><code>&lt;?php
namespace app\index\controller;
use think\facade\Config;
use app\index\controller\user\Blog;

class Index
{
    public function index()
    {
        $bolg = new Blog();
        return $bolg -&gt;index();
        // return request()-&gt;controller();
    }
}
</code></pre>
<p>4.æ§åˆ¶ç±»ç»§æ‰¿ extends<br>
use ä¸€ä¸‹éœ€è¦ç»§æ‰¿çš„ç±»æ–‡ä»¶<br>
ç„¶åç›´æ¥ç»§æ‰¿ä¾¿å¯ä»¥è°ƒç”¨ç±»æ–¹æ³•</p>
<pre><code>&lt;?php
namespace app\index\controller;
use think\facade\Config;

class Index extends Config
{
    public function index()
    {
        var_dump(Config::get('app'));
        // return request()-&gt;controller();
    }
}
</code></pre>
<p>5.ç©ºæ§åˆ¶å™¨<br>
ç©ºæ§åˆ¶å™¨çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œå½“è®¿é—®åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œå¯ä»¥ä½œä¸ºå½“å‰æ§åˆ¶ä¸‹çš„404é”™è¯¯URLä¼˜åŒ–ä½¿ç”¨ã€‚</p>
<pre><code>&lt;?php
namespace app\index\controller;

class Index
{
    public function __call($method, $args)
    {
        return 'è°ƒç”¨å½“å‰ç©ºæ§åˆ¶å™¨æ–¹æ³•ï¼';
    }

    public function index()
    {
        return 'index';
    }
}
</code></pre>
<p>å½“æˆ‘è®¿é—®ä¸å­˜åœ¨çš„ hello æ–¹æ³•æ—¶â†“<br>
<img src="https://UserNameZjw.github.io/post-images/1560522078557.png" alt=""></p>
<h3 id="æ¸²æŸ“è¾“å‡º">æ¸²æŸ“è¾“å‡º</h3>
<p>æ§åˆ¶å™¨ä¸€èˆ¬ä¸éœ€è¦ä»»ä½•è¾“å‡ºï¼Œç›´æ¥ return å³å¯<br>
ä¸è¦åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨ dieã€exit ç­‰ç±»ä¼¼çš„ä¸­æ–­ä»£ç ï¼Œéœ€è¦è°ƒè¯•ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½® halt åŠ©æ‰‹å‡½æ•°ã€‚<br>
éƒ¨åˆ†ç³»ç»Ÿæœ‰æ•ˆè¾“å‡ºâ†“</p>
<pre><code>&lt;?php
namespace app\index\controller;

class Index 
{
    public function hello()
    {
    	// è¾“å‡ºhello,world!
        return 'hello,world!';
    }
    
    public function json()
    {
    	// è¾“å‡ºJSON
        return json($data);
    }
    
    public function read()
    {
    	// æ¸²æŸ“é»˜è®¤æ¨¡æ¿è¾“å‡º
        return view();
    }

}
</code></pre>
<h3 id="è·¯ç”±">è·¯ç”±</h3>
<p>å¤šçº§æ§åˆ¶å™¨å®˜æ–¹æ¨èè®¿é—®æ–¹æ³•ä¸º è‡ªå®šä¹‰é…ç½®è·¯ç”±<br>
ä¸‹èŠ‚å†èŠğŸ¤£ğŸ¤£ğŸ¤£</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://UserNameZjw.github.io/tag/js73X3rii" class="tag">
                    ThinkPHP
                  </a>
                
                  <a href="https://UserNameZjw.github.io/tag/ot5L6E5ha" class="tag">
                    ThinkPHP 6.0
                  </a>
                
                  <a href="https://UserNameZjw.github.io/tag/uFYHgUoyG" class="tag">
                    PHP
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://UserNameZjw.github.io/post/Mac-error">
                  <h3 class="post-title">
                    ã€å¤±è¯¯ã€‘Mac ä¸Šå…³äºé“¾æ¥æœ¬åœ°MySQLæ•°æ®åº“çš„æŠ¥é”™2002
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '19e99227bee7425b84fe',
        clientSecret: 'fd6e22f86390c0075ff9db20e16c5221d27dbf9f',
        repo: 'UserNameZjw.github.io',
        owner: 'UserNameZjw',
        admin: ['UserNameZjw'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
